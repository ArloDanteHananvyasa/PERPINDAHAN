<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/Assets/umk/rekamTransaksi/penjualan.css">
    <title>Penjualan</title>
</head>

<body>
    <div class="page-container">

        <div class="logo">
            <p class="wovey">Wovey<br />Foodcourt .</p>
        </div>

        <!-- Header Section -->
        <div class="header">
            <p class="dashboard-header"><span class="transaksiClass"><a th:href="@{/umk/transaksi}">Transaksi</a></span>
                > <span class="biayaOpsClass">Penjualan</span></p>
            <img class="profile" src="/Assets/umk/rekamTransaksi/generic-avatar0.svg" />
        </div>

        <div class="sidebar">
            <div class="navigation">
                <div class="menu-item dashboard">
                    <img class="icon-dashboard" src="/Assets/umk/rekamTransaksi/icon-nav-dashboard0.svg" />
                    <p class="nav-dashboard"><a th:href="@{/umk/home}">Dashboard</a></p>
                </div>

                <div class="menu-item produk">
                    <img class="icon-produk" src="/Assets/umk/rekamTransaksi/icon-produk.svg" />
                    <p class="nav-produk"><a th:href="@{/umk/produk}">Produk</a></p>
                </div>

                <div class="menu-item transaksi">
                    <img class="icon-transaksi" src="/Assets/umk/rekamTransaksi/icon-transaksi0.svg" />
                    <p class="nav-transaksi"><a th:href="@{/umk/transaksi}">Transaksi</a></p>
                    <!-- <span class="badge">13</span> -->
                </div>

                <div class="menu-item keuangan">
                    <img class="icon-keuangan" src="/Assets/umk/rekamTransaksi/icon-keuangan0.svg" />
                    <p class="nav-keuangan"><a th:href="@{/umk/keuangan}">Keuangan</a></p>
                </div>
                <div class="menu-item penjualan">
                    <img class="icon-penjualan" src="/Assets/umk/rekamTransaksi/icon-penjualan.svg" />
                    <p class="nav-penjualan"><a th:href="@{/umk/penjualan}">Penjualan</a></p>
                </div>

                <div class="nav-divider">
                    <hr class="solid" />
                </div>

                <div class="menu-item log-out">
                    <img class="icon-log-out" src="/Assets/umk/rekamTransaksi/icon-logout.svg" />
                    <p class="nav-log-out"><a th:href="@{/login/out}">Log Out</a></p>
                </div>
            </div>
        </div>
        <div class="main-content">
            <div class="title">
                Penjualan
            </div>
            <div class="content-container">
                <div class="form-container">
                    <form th:action="@{/umk/transaksi/penjualan-produk/tambah}" method="post">
                        <div class="label-input-container">
                            <div class="form-group">
                                <label for="tanggal">Masukkan tanggal transaksi</label>
                                <input type="date" id="tanggal" name="tanggal" th:value="${tanggal}" required>
                            </div>
                            <div class="form-group">
                                <label for="pilih-produk">Pilih Produk</label>
                                <select id="pilih-produk" name="pilih-produk" class="form-control" required>
                                    <option value="" disabled selected>Select a product</option>
                                    <option th:each="product : ${products}" th:value="${product.namaProduk}"
                                        th:attr="data-price=${product.harga}" th:text="${product.namaProduk}">
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="jumlah">Masukkan jumlah produk terjual</label>
                                <input type="number" id="jumlah" name="jumlah" min="1" value="1"
                                    placeholder="Contoh : 5" required>
                            </div>
                            <div class="form-group">
                                <label for="hargaTotal">Total harga</label>
                                <span>Rp. </span><input type="text" id="hargaTotal" name="hargaTotal" readonly>
                            </div>
                        </div>

                        <input type="submit" class="add-btn" value="Tambah" />
                    </form>
                    <form th:action="@{/umk/transaksi/penjualan-produk/submit}" method="get">
                        <button type="submit" class="submit-btn">Selesai Transaksi</button>
                    </form>
                </div>
                <div class="container-saldo">
                    <img src="/Assets/umk/rekamTransaksi/icon-saldo0.svg" class="logo-saldo">
                    <div class="saldo-title">
                        Saldo anda saat ini
                    </div>
                    <div class="nominal-saldo">
                        <p th:text="${saldo}"></p>
                    </div>
                </div>
                <div class="bon">
                    <table class="tabelBon">
                        <tr>
                            <th>No</th>
                            <th>Nama Produk</th>
                            <th>Jumlah</th>
                            <th>Total Harga</th>
                        </tr>
                        <tr th:each="item, iterStat: ${results}">
                            <td th:text="${iterStat.index + 1}"></td>
                            <td th:text="${item.namaProduk}"></td>
                            <td th:text="${item.jumlah}"></td>
                            <td th:text="${item.total}"></td>
                        </tr>
                    </table>
                </div>
                <!-- <img src="/Assets/umk/rekamTransaksi/biaya-operasional.png"> -->

            </div>
        </div>
    </div>
    <script>
        document.getElementById('pilih-produk').addEventListener('change', updateTotal);
        document.getElementById('jumlah').addEventListener('input', updateTotal);

        function updateTotal() {
            const select = document.getElementById('pilih-produk');
            const quantityInput = document.getElementById('jumlah');
            const totalInput = document.getElementById('hargaTotal');

            // Get selected option's data-price attribute
            const selectedOption = select.options[select.selectedIndex];
            const price = parseFloat(selectedOption.getAttribute('data-price') || 0);

            // Get quantity value and ensure it's a number
            const quantity = parseInt(quantityInput.value || 0);

            // Calculate the total price
            const total = price * quantity;

            // Update the readonly input with the calculated total
            totalInput.value = total; // Ensures 2 decimal places
        }
    </script>
</body>

</html>